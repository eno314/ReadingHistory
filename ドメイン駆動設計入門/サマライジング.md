# ドメイン駆動設計入門 サマライジング

## はじめに ~ 目次

この本の目的は「DDDに立ち向かうための準備」だよ。この本を読んだだけでDDDを実践できるようになるわけじゃないけど、DDDを実践するためのベースの知識（実装パターン）を身につけることができるよ。

## Chapter1

DDDのゴールと本書のゴールを確認するための章だよ。

- DDD
  - ゴール : 「ソフトウェア利用者を取り巻く世界の知識をコードに埋め込む」
  - 理由 : ソフトウェアシステムを長期的に安定して運用するため
- 本書
  - ゴール : 「DDDに立ち向かうための準備」
  - 理由 : DDDは難しい。いきなり全部を理解するのは大変だし、実践しにくいプラクティスもある。だから本書は、理解・実践がしやすいものに絞って説明していて、それによって理解・実践が難しい概念の理解に繋げてもらうことを目的にしている

- 本書で学ぶパターンの俯瞰図
  - 知識を表現 : 「値オブジェクト」「エンティティ」「ドメインサービス」
  - アプリケーションを表現 : 「リポジトリ」「アプリケーションサービス」「ファクトリ」
  - 知識表現の発展系 : 「集約」「仕様」

## Chapter2

値オブジェクトは「システムならではの値を表現したオブジェクト」。ドメインオブジェクトの基本だから、ドメイン知識をモデリングする際は値オブジェクトを最初に検討してみると良いよ。

- 値オブジェクトの性質 : 「不変」「交換可能」「等価性があって比較も可能」
- 値オブジェクトにする基準 : 「ルールが存在するか」「それ単体で扱いたいか」
- 値オブジェクトのメリット : 「表現力」「変な値を許可しない」「誤った代入を防ぐ」「ロジックを散らばらせない」

## Chapter3

エンティティは「属性で区別できないけど、同一性を担保する何かを持っているオブジェクト」。人間が良い例で、身長や体重・年齢が変わってもその人はその人だし、同じ年齢で同姓同名の人がいても同一人物とは限らない。

値オブジェクトとは性質が対になるような関係だけど、ドメイン領域によって同じ概念でも値オブジェクトになったりエンティティになったりするものもあるから注意しようね。例えば、車におけるタイヤは値オブジェクトだけど、タイヤ製造工場におけるタイヤはエンティティだよ。

ちなみにソフトウェア開発においてエンティティという単語は良く出てくるから混乱しないように気をつけよう。

## Chapter4

ドメインサービスは「値オブジェクトやエンティティの振る舞いとしては微妙なドメイン知識のためのオブジェクト」だよ。例えば、複数のドメインオブジェクトを横断するような操作とかだね。でも、値オブジェクトやエンティティの振る舞いとして違和感が無いんであれば無理にドメインサービスを作る必要は無いよ。乱用は良くないよ。

ちなみにソフトウェア開発におけるサービスは「クライアントのために何かを行うもの」だよ。

## Chapter5

リポジトリはデータの保管庫を表すオブジェクトで、ドメインにデータの保管場所について意識させないようにするためのものだよ。リポジトリを用意することで、ソフトウェアは柔軟になるよ。例えば開発初期にストレージをどうするか決まっていない場合でも、一旦インメモリや単純なファイルで読み書きするようにしておいて、後から正式なストレージが決まったあとで置き換える、なんてこともやりやすいよ。

## Chapter6

アプリケーションサービスは「アプリケーション固有の機能を表現するもの」だよ。いわゆる「ユースケース」と呼ばれるもの。言い換えるなら、そのアプリケーションの利用者の目的を達成する処理が詰まったもの。

ドメインオブジェクトがちゃんとしていれば、アプリケーションサービスはドメインオブジェクトを操作するだけになるはずだよ。

## Chapter7

ソフトウェアを柔軟にするためには、依存関係のコントロールが不可欠だよ。依存関係をコントロールにはDIP（依存関係逆転の原則）を使うんだよ。

DDDではドメインを技術的な要素に依存させないようにすることで、ソフトウェアを柔軟にするよ。リポジトリのパターンがその例だよ。

## Chapter8

2~7章までに紹介したものを使って、UIに組み込み、ユーザーが使えるようにする方法を説明するサンプルコードが多めの章だよ。

ユーザーインターフェースはアプリケーションから分離させて、交換可能なものにしておくのが良いよ。なぜならテストの自動化がしやすいからね。UIを交換するような事態も絶対にないとは言い切れないよ。

## Chapter9

オブジェクトを生成する処理は、モデルを表現するオブジェクトとは分離したほうが良いよ。道具を作ることと使うことは全く別の知識だからね。ファクトリはそんな「オブジェクトを生成する責務」を持ったオブジェクトだよ。

## Chapter10

データの整合性を保つためのトランザクションを、どう扱うのが良いか説明する章だよ。何パターンかサンプルコード付きで紹介しているから、今のプロジェクトにはどれが最適なのか考えてみると良いよ。

## Chapter11

10章までの内容を使って、アプリケーションを1から組み立てていく過程を見ることで、今までの内容の復習をするのための章だよ。この章でやったような練習を他でもやってみると力になるよ。

## Chapter12

集約は「データを変更するための単位として扱われるオブジェクトの集まり」で、カプセル化を使ってオブジェクト内部の操作を制限するのが目的のオブジェクトだよ。

システマティックに定義できるものではないから、最初から完璧に作ろうとはせず、ドメイン知識を増やしながら育てていくものだと思うのが良さそう。

## Chapter13

仕様は「オブジェクトの評価を行うオブジェクト」だよ。単純な評価であればオブジェクト自身に持たせればいいけど、複雑な場合は仕様オブジェクトとして切り出したほうが分かりやすいこともあるよ。

ちなみに評価は、オブジェクトがどういった状態かを確認する振る舞いであって、例えば、満員かどうかみたいなbooleanを返すメソッドだよ。

## Chapter14

DDDは本来はアーキテクチャには縛られない。ドメインオブジェクトを他から隔離できれば、どんなアーキテクチャであっても構わないんだよ。逆に言えば、特定のアーキテクチャにしたからと言ってDDDを実践していることにはならないということだね。

とはいえ何らかのアーキテクチャに従うことでDDDを実践しやすくなることもあるので、この章ではレイヤードアーキテクチャ・ヘキサゴナルアーキテクチャ・クリーンアーキテクチャの実装例を紹介してくれているよ。

## Chapter15

今後の学習の手引をする章だよ。

14章までの内容を取りれただけではDDDの目標を達成できるわけじゃない。DDDの目標を達成するにはドメインについて深く理解する必要があって、そのためのプラクティスもDDDには含まれている。

この章では軽くそんなプラクティスについても触れているけど、実際に「エリック・エヴァンスのドメイン駆動設計」を読んで、そしてその内容をソフトウェア開発で実践してみよう。

## Appendix

### A.1

ソフトウェア開発の最初の1歩

### A.2

ソリューション構成
